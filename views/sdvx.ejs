<%
  name = {
    fumen: ['nov', 'adv', 'exh', 'inf'],
    rank: ['D', 'C', 'B', 'A', 'AA', 'AAA'],
    clear: ['FAIL', 'CLR', 'H-CLR', 'UC', 'PUC'],
    clear_short: 'FCHUP',
    count: {
      long: ['PLAY', 'CLEAR', 'UC', 'PUC'],
      short: ['PLAY', 'CL', 'UC', 'PUC'],
      class: ['play', 'clear', 'uc', 'puc']
    }
  };
%>
<%- include('partial/header', {
  left: true,
  right: true,
  title: '아즈인포 - ' + meta.nickname
}) %>
<header>
  <div class="title">
    <div class="left">
      <span class="skill-level" data-skill-level="<%= meta.skill_no %>">
        <span class="skill-level-title">
          <%= meta.skill_name %>
        </span>
      </span>
      <h1>
        <%= meta.name %>
      </h1>
    </div>
    <div class="right">
      <dl>
        <dt>플레이</dt>
        <dd><%= meta.play %></dd>
        <dt>패킷</dt>
        <dd><%= meta.packet %></dd>
        <dt>블럭</dt>
        <dd><%= meta.block %></dd>
      </dl>
    </div>
  </div>
  <div class="card-container">
    <ol class="statistics" start="17" reversed>
      <% for(var i = 16; i >= 0; i--) { %>
        <li>
          <% var level = stat[i] %>
          <h4>
            <big><%= i === 16? 'Overview' : 'lv.' + (i + 1) %></big>
            × ??? 중
            <%= level.count %> /
            <%= level.totalcount %>,
            순회율 <%= (level.count / level.totalcount * 100).toFixed(1) %>% |
            평균 <%= ~~(level.total / level.count) %>
          </h4>
          <div class="statbar">
            <% for(var j in level.clear) { %>
              <% if(level.clear[j]) { %>
                <div class="stat stat-clear-<%= j %>"
                     style="width: <%= level.clear[j] / level.count * 100 %>%">
                  <%= name.clear_short[j] %><br />
                  <%= level.clear[j] %>
                  /
                  <%= (level.clear[j] / level.count * 100).toFixed(1) %>%
                </div>
              <% } %>
            <% } %>
          </div>
          <div class="statbar">
            <% for(var j in level.rank) { %>
              <% if(level.rank[j]) { %>
                <div class="stat stat-rank-<%= j %>"
                     style="width: <%= level.rank[j] / level.count * 100 %>%">
                  <%= name.rank[j] %><br />
                  <%= level.rank[j] %>
                  /
                  <%= (level.rank[j] / level.count * 100).toFixed(1) %>%
                </div>
              <% } %>
            <% } %>
          </div>
        </li>
      <% } %>
    </ol>
  </div>
</header>
<main>
  <ul class="list-song">
    <% for(var song in songs) { %>
      <% var song = songs[song]; %>
      <% for(var f in name.fumen) { %>
        <% var current = name.fumen[f]; %>
        <% var fumen = song[current]; %>
        <% if(fumen === undefined || fumen.score === undefined) continue; %>
        <li class="song <%= (song.isGravity && current == 'inf')? 'grv' : current %>">
          <img class="albumart"
               src="http://<%= api.cdn + fumen.illust %>" />
          <div class="side">
            <dl>
              <% for(var p=0; p<4; p++) { %>
                <% var disabled = (p >= 2 && fumen.count[p] == 0)? 'disabled' : ''; %>
                <% var len = (fumen.count[p] > 99)? 'short' : 'long'; %>
                <dt class="<%= disabled %>">
                  <%= name.count[len][p] %>
                </dt>
                <dd class="<%= disabled %> count-<%= name.count.class[p] %>">
                  <%= fumen.count[p] %>
                </dd>
              <% } %>
            </dl>
          </div>
          <div class="top">
            <span class="level skew">
              <span class="unskew">
                <%= fumen.level %>
              </span>
            </span>
            <h1> <%= song.title %> </h1>
            <h2> <%= song.artist %> </h2>
          </div>
          <div class="bottom">
            <span class="clear clear-<%= fumen.clear %>">
              <span class="unskew"> <%= name.clear[fumen.clear] %> </span>
            </span><!--
         --><span class="rank rank-<%= fumen.rank %>">
              <span class="unskew"> <%= name.rank[fumen.rank] %> </span>
            </span>
            <span class="score">
              <%= fumen.score %>
            </span>
          </div>
        </li>
      <% } %>
    <% } %>
  </ul>
</main>
<%- include('partial/nav', {
  left: true,
  right: true
}) %>
<aside class="right">
  <div class="nav-header">
    <span class="title">
      정렬
    </span>
    <label for="reset" class="nav-button right">
      <svg class="icon" width="1.5em" height="1.5em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 18h6v-2H3v2zM3 6v2h18V6H3zm0 7h12v-2H3v2z"/>
      </svg>
    </label>
  </div>
</aside>
<%- include('partial/footer') %>
